import{a as wt}from"./chunk-LOMLEGJP.js";import{f as d,j as h}from"./chunk-NZGOIL2E.js";var b=d((Bt,H)=>{h();function f(t){return t&&typeof t=="object"&&!Array.isArray(t)&&t!==null}H.exports=function t(e,n){return f(e)&&f(n)&&Object.keys(n).forEach(o=>{f(n[o])?((!e[o]||!f(e[o]))&&(e[o]=n[o]),t(e[o],n[o])):Object.assign(e,{[o]:n[o]})}),e}});var O=d((zt,F)=>{h();F.exports=function(e,n,o=!1){let i=null,r=!0;return(...l)=>{let s=o&&r,c=()=>{e.apply(this,l),i=null};s&&(r=!1,c()),i||(i=setTimeout(c,n))}}});var A=d((Ut,$)=>{h();$.exports=function(e,n){let o;return(...i)=>{let r=this;clearTimeout(o),o=setTimeout(()=>e.apply(r,i),n)}}});var N=d((Pt,M)=>{h();M.exports=function(e=""){return e.replace(/\r\n/g,`
`)}});var G=d((Jt,x)=>{h();x.exports=function(e,n,o,i){let r=o-e,l=e+r/2;return`M ${e} ${n} C ${l},${n} ${l},${i} ${o},${i}`}});var _=d((Zt,q)=>{h();q.exports={DIFF_EQUAL:0,DIFF_DELETE:-1,DIFF_INSERT:1,EDITOR_RIGHT:"right",EDITOR_LEFT:"left",RTL:"rtl",LTR:"ltr",SVG_NS:"http://www.w3.org/2000/svg",DIFF_GRANULARITY_SPECIFIC:"specific",DIFF_GRANULARITY_BROAD:"broad"}});var B=d((te,V)=>{h();var k=_();V.exports=function(e,n){let{mode:o}=e.options;return n===k.EDITOR_LEFT&&e.options.left.mode!==null&&(o=e.options.left.mode),n===k.EDITOR_RIGHT&&e.options.right.mode!==null&&(o=e.options.right.mode),o}});var Y=d((ne,z)=>{h();var W=_();z.exports=function(e,n){let{theme:o}=e.options;return n===W.EDITOR_LEFT&&e.options.left.theme!==null&&(o=e.options.left.theme),n===W.EDITOR_RIGHT&&e.options.right.theme!==null&&(o=e.options.right.theme),o}});var j=d((re,U)=>{h();U.exports=function(e,n){return e.ace.getSession().doc.getLine(n)}});var Q=d((se,P)=>{h();P.exports=function(e){return document.getElementById(e.options.left.id).offsetHeight}});var K=d((ce,J)=>{h();J.exports=function(e){let n=document.createElement("div"),o={class:e.className,style:`top:${e.topOffset}px`,title:e.tooltip,"data-diff-index":e.diffIndex};for(let i in o)n.setAttribute(i,o[i]);return n.innerHTML=e.arrowContent,n}});var X=d((he,Z)=>{h();Z.exports=function(e,n){let o=Math.random().toString(36).substr(2,5),i=`js-${n}-${o}`,r=e.querySelector(`.${n}`);if(r)return r.id=r.id||i,r.id;let l=document.createElement("div");return e.appendChild(l),l.className=n,l.id=i,l.id}});var et=d((ue,tt)=>{h();function vt(t,e,n,o){let i=t==="document"?document:document.querySelector(t);i.addEventListener(e,r=>{let l=i.querySelectorAll(n),{target:s}=r;for(let c=0,u=l.length;c<u;c+=1){let a=s,L=l[c];for(;a&&a!==i;)a===L&&o.call(L,r),a=a.parentNode}})}tt.exports={on:vt}});var Vt=d((pe,_t)=>{h();var Ht=wt(),Et=b(),nt=O(),bt=A(),ot=N(),rt=G(),it=B(),st=Y(),Ct=j(),Ft=Q(),lt=K(),w=X(),ct=et(),g=_(),y;function Ot(t){if(t.Range)return t.Range;let e=t.acequire||t.require;return e?e("ace/range"):!1}function D(t={}){if(!(this instanceof D))return new D(t);let e=this,n=()=>window?window.ace:void 0;e.options=Et({ace:n(),mode:null,theme:null,element:null,diffGranularity:g.DIFF_GRANULARITY_BROAD,lockScrolling:!1,showDiffs:!0,showConnectors:!0,maxDiffs:5e3,left:{id:null,content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},right:{id:null,content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},classes:{gutterID:"acediff__gutter",diff:"acediff__diffLine",connector:"acediff__connector",newCodeConnectorLink:"acediff__newCodeConnector",newCodeConnectorLinkContent:"&#8594;",deletedCodeConnectorLink:"acediff__deletedCodeConnector",deletedCodeConnectorLinkContent:"&#8592;",copyRightContainer:"acediff__copy--right",copyLeftContainer:"acediff__copy--left"},connectorYOffset:0},t);let{ace:o}=e.options;if(!o){let i="No ace editor found nor supplied - `options.ace` or `window.ace` is missing";return console.error(i),new Error(i)}if(y=Ot(o),!y){let i="Could not require Range module for Ace. Depends on your bundling strategy, but it usually comes with Ace itself. See https://ace.c9.io/api/range.html, open an issue on GitHub ace-diff/ace-diff";return console.error(i),new Error(i)}if(e.options.element===null){let i="You need to specify an element for Ace-diff - `options.element` is missing";return console.error(i),new Error(i)}if(e.options.element instanceof HTMLElement?e.el=e.options.element:e.el=document.body.querySelector(e.options.element),!e.el){let i=`Can't find the specified element ${e.options.element}`;return console.error(i),new Error(i)}e.options.left.id=w(e.el,"acediff__left"),e.options.classes.gutterID=w(e.el,"acediff__gutter"),e.options.right.id=w(e.el,"acediff__right"),e.el.innerHTML=`<div class="acediff__wrap">${e.el.innerHTML}</div>`,e.editors={left:{ace:o.edit(e.options.left.id),markers:[],lineLengths:[]},right:{ace:o.edit(e.options.right.id),markers:[],lineLengths:[]},editorHeight:null},e.editors.left.ace.getSession().setMode(it(e,g.EDITOR_LEFT)),e.editors.right.ace.getSession().setMode(it(e,g.EDITOR_RIGHT)),e.editors.left.ace.setReadOnly(!e.options.left.editable),e.editors.right.ace.setReadOnly(!e.options.right.editable),e.editors.left.ace.setTheme(st(e,g.EDITOR_LEFT)),e.editors.right.ace.setTheme(st(e,g.EDITOR_RIGHT)),e.editors.left.ace.setValue(ot(e.options.left.content),-1),e.editors.right.ace.setValue(ot(e.options.right.content),-1),e.editors.editorHeight=Ft(e),setTimeout(()=>{e.lineHeight=e.editors.left.ace.renderer.lineHeight,$t(e),xt(e),It(e),e.diff()},1)}D.prototype={setOptions(t){Et(this.options,t),this.diff()},getNumDiffs(){return this.diffs.length},getEditors(){return{left:this.editors.left.ace,right:this.editors.right.ace}},diff(){let t=new Ht,e=this.editors.left.ace.getSession().getValue(),n=this.editors.right.ace.getSession().getValue(),o=t.diff_main(n,e);t.diff_cleanupSemantic(o),this.editors.left.lineLengths=ht(this.editors.left),this.editors.right.lineLengths=ht(this.editors.right);let i=[],r={left:0,right:0};o.forEach((l,s,c)=>{let u=l[0],a=l[1];c[s+1]&&a.endsWith(`
`)&&c[s+1][1].startsWith(`
`)&&(a+=`
`,o[s][1]=a,o[s+1][1]=o[s+1][1].replace(/^\n/,"")),a.length!==0&&(u===g.DIFF_EQUAL?(r.left+=a.length,r.right+=a.length):u===g.DIFF_DELETE?(i.push(dt(this,g.DIFF_DELETE,r.left,r.right,a)),r.right+=a.length):u===g.DIFF_INSERT&&(i.push(dt(this,g.DIFF_INSERT,r.left,r.right,a)),r.left+=a.length))},this),this.diffs=kt(this,i),!(this.diffs.length>this.options.maxDiffs)&&(Tt(this),ft(this))},destroy(){let t=this.editors.left.ace.getValue();this.editors.left.ace.destroy();let e=this.editors.left.ace.container,n=e.cloneNode(!1);n.textContent=t,e.parentNode.replaceChild(n,e);let o=this.editors.right.ace.getValue();this.editors.right.ace.destroy(),e=this.editors.right.ace.container,n=e.cloneNode(!1),n.textContent=o,e.parentNode.replaceChild(n,e),document.getElementById(this.options.classes.gutterID).innerHTML="",St()}};var St=()=>{};function $t(t){t.editors.left.ace.getSession().on("changeScrollTop",nt(()=>{ut(t)},16)),t.editors.right.ace.getSession().on("changeScrollTop",nt(()=>{ut(t)},16));let e=t.diff.bind(t);t.editors.left.ace.on("change",e),t.editors.right.ace.on("change",e),t.options.left.copyLinkEnabled&&ct.on(`#${t.options.classes.gutterID}`,"click",`.${t.options.classes.newCodeConnectorLink}`,o=>{at(t,o,g.LTR)}),t.options.right.copyLinkEnabled&&ct.on(`#${t.options.classes.gutterID}`,"click",`.${t.options.classes.deletedCodeConnectorLink}`,o=>{at(t,o,g.RTL)});let n=bt(()=>{t.editors.availableHeight=document.getElementById(t.options.left.id).offsetHeight,t.diff()},250);window.addEventListener("resize",n),St=()=>{window.removeEventListener("resize",n)}}function at(t,e,n){let o=parseInt(e.target.getAttribute("data-diff-index"),10),i=t.diffs[o],r,l,s,c,u,a;n===g.LTR?(r=t.editors.left,l=t.editors.right,s=i.leftStartLine,c=i.leftEndLine,u=i.rightStartLine,a=i.rightEndLine):(r=t.editors.right,l=t.editors.left,s=i.rightStartLine,c=i.rightEndLine,u=i.leftStartLine,a=i.leftEndLine);let L="";for(let E=s;E<c;E+=1)L+=`${Ct(r,E)}
`;let m=l.ace.getSession().getScrollTop();l.ace.getSession().replace(new y(u,0,a,0),L),l.ace.getSession().setScrollTop(parseInt(m,10)),t.diff()}function ht(t){let e=t.ace.getSession().doc.getAllLines(),n=[];return e.forEach(o=>{n.push(o.length+1)}),n}function gt(t,e,n,o,i){let r=t.editors[e];o<n&&(o=n);let l=`${i} ${o>n?"lines":"targetOnly"}`;r.markers.push(r.ace.session.addMarker(new y(n,0,o-1,1),l,"fullLine"))}function ut(t){Tt(t),ft(t),Nt(t)}function Tt(t){t.editors.left.markers.forEach(e=>{t.editors.left.ace.getSession().removeMarker(e)},t),t.editors.right.markers.forEach(e=>{t.editors.right.ace.getSession().removeMarker(e)},t)}function At(t,e,n,o,i){let r=t.editors.left.ace.getSession().getScrollTop(),l=t.editors.right.ace.getSession().getScrollTop();t.connectorYOffset=1;let s=-1,c=e*t.lineHeight-r+.5,u=t.gutterWidth+1,a=o*t.lineHeight-l+.5,L=-1,m=n*t.lineHeight-r+t.connectorYOffset+.5,E=t.gutterWidth+1,S=i*t.lineHeight-l+t.connectorYOffset+.5,yt=rt(s,c,u,a),I=rt(E,S,L,m),Dt=`L${u},${a} ${E},${S}`,T=`L${L},${m} ${s},${c}`,Rt=`${yt} ${Dt} ${I} ${T}`,R=document.createElementNS(g.SVG_NS,"path");R.setAttribute("d",Rt),R.setAttribute("class",t.options.classes.connector),t.gutterSVG.appendChild(R)}function Mt(t,e,n){if(e.leftEndLine>e.leftStartLine&&t.options.left.copyLinkEnabled){let o=lt({className:t.options.classes.newCodeConnectorLink,topOffset:e.leftStartLine*t.lineHeight,tooltip:"Copy to right",diffIndex:n,arrowContent:t.options.classes.newCodeConnectorLinkContent});t.copyRightContainer.appendChild(o)}if(e.rightEndLine>e.rightStartLine&&t.options.right.copyLinkEnabled){let o=lt({className:t.options.classes.deletedCodeConnectorLink,topOffset:e.rightStartLine*t.lineHeight,tooltip:"Copy to left",diffIndex:n,arrowContent:t.options.classes.deletedCodeConnectorLinkContent});t.copyLeftContainer.appendChild(o)}}function Nt(t){let e=t.editors.left.ace.getSession().getScrollTop(),n=t.editors.right.ace.getSession().getScrollTop();t.copyRightContainer.style.cssText=`top: ${-e}px`,t.copyLeftContainer.style.cssText=`top: ${-n}px`}function dt(t,e,n,o,i){let r={},l=/^\n/.test(i);if(e===g.DIFF_INSERT){var s=pt(t.editors.left,n,i),c=Lt(t.editors.right,o),u=C(t.editors.right,c);let E=C(t.editors.left,s.startLine);var a=C(t.editors.left,s.startLine);let S=c;a===0&&l&&(l=!1),s.startChar===0&&v(t.editors.right,o,l)&&(S=c+1);var L=s.startLine===s.endLine,m=0;(s.startChar>0||L&&i.length<E)&&u>0&&s.startChar<E&&m++,r={leftStartLine:s.startLine,leftEndLine:s.endLine+1,rightStartLine:S,rightEndLine:S+m}}else{var s=pt(t.editors.right,o,i),c=Lt(t.editors.left,n),u=C(t.editors.left,c);let I=C(t.editors.right,s.startLine);var a=C(t.editors.right,s.startLine);let T=c;a===0&&l&&(l=!1),s.startChar===0&&v(t.editors.left,n,l)&&(T=c+1);var L=s.startLine===s.endLine,m=0;(s.startChar>0||L&&i.length<I)&&u>0&&s.startChar<I&&m++,r={leftStartLine:T,leftEndLine:T+m,rightStartLine:s.startLine,rightEndLine:s.endLine+1}}return r}function pt(t,e,n){let o={startLine:0,startChar:0,endLine:0,endChar:0},i=e+n.length,r=0,l=!1,s=!1;t.lineLengths.forEach((u,a)=>{r+=u,!l&&e<r&&(o.startLine=a,o.startChar=e-r+u,l=!0),!s&&i<=r&&(o.endLine=a,o.endChar=i-r+u,s=!0)}),o.startChar>0&&C(t,o.startLine)===o.startChar&&(o.startLine++,o.startChar=0),o.endChar===0&&o.endLine--;let c=/\n$/.test(n);return o.startChar>0&&c&&o.endLine++,o}function C(t,e){return Ct(t,e).length}function Lt(t,e){let n=t.ace.getSession().doc.getAllLines(),o=0,i=0;for(let r=0;r<n.length;r+=1)if(i+=n[r].length+1,e<=i){o=r;break}return o}function v(t,e,n){let o=t.ace.getSession().doc.getAllLines(),i=0;for(let r=0;r<o.length;r+=1){i+=o[r].length+1;let l=i;if(n&&(l-=1),e===l)break}return v}function It(t){t.gutterHeight=document.getElementById(t.options.classes.gutterID).clientHeight,t.gutterWidth=document.getElementById(t.options.classes.gutterID).clientWidth;let e=mt(t,g.EDITOR_LEFT),n=mt(t,g.EDITOR_RIGHT),o=Math.max(e,n,t.gutterHeight);t.gutterSVG=document.createElementNS(g.SVG_NS,"svg"),t.gutterSVG.setAttribute("width",t.gutterWidth),t.gutterSVG.setAttribute("height",o),document.getElementById(t.options.classes.gutterID).appendChild(t.gutterSVG)}function mt(t,e){return(e===g.EDITOR_LEFT?t.editors.left:t.editors.right).ace.getSession().getLength()*t.lineHeight}function xt(t){t.copyRightContainer=document.createElement("div"),t.copyRightContainer.setAttribute("class",t.options.classes.copyRightContainer),t.copyLeftContainer=document.createElement("div"),t.copyLeftContainer.setAttribute("class",t.options.classes.copyLeftContainer),document.getElementById(t.options.classes.gutterID).appendChild(t.copyRightContainer),document.getElementById(t.options.classes.gutterID).appendChild(t.copyLeftContainer)}function Gt(t){document.getElementById(t.options.classes.gutterID).removeChild(t.gutterSVG),It(t)}function qt(t){t.copyLeftContainer.innerHTML="",t.copyRightContainer.innerHTML=""}function kt(t,e){let n=[];function o(r){return t.options.diffGranularity===g.DIFF_GRANULARITY_SPECIFIC?r<1:r<=1}e.forEach((r,l)=>{if(l===0){n.push(r);return}let s=!1;for(let c=0;c<n.length;c+=1)if(o(Math.abs(r.leftStartLine-n[c].leftEndLine))&&o(Math.abs(r.rightStartLine-n[c].rightEndLine))){n[c].leftStartLine=Math.min(r.leftStartLine,n[c].leftStartLine),n[c].rightStartLine=Math.min(r.rightStartLine,n[c].rightStartLine),n[c].leftEndLine=Math.max(r.leftEndLine,n[c].leftEndLine),n[c].rightEndLine=Math.max(r.rightEndLine,n[c].rightEndLine),s=!0;break}s||n.push(r)});let i=[];return n.forEach(r=>{r.leftStartLine===r.leftEndLine&&r.rightStartLine===r.rightEndLine||i.push(r)}),i}function ft(t){Gt(t),qt(t),t.diffs.forEach((e,n)=>{t.options.showDiffs&&(gt(t,g.EDITOR_LEFT,e.leftStartLine,e.leftEndLine,t.options.classes.diff),gt(t,g.EDITOR_RIGHT,e.rightStartLine,e.rightEndLine,t.options.classes.diff),t.options.showConnectors&&At(t,e.leftStartLine,e.leftEndLine,e.rightStartLine,e.rightEndLine),Mt(t,e,n))},t)}_t.exports=D});export default Vt();
